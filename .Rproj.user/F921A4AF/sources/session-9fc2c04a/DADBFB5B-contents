######################################################################################################################################################
######################################################################################################################################################

#IMPORTAÇÃO DE ARQUIVOS

######################################################################################################################################################
######################################################################################################################################################

#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#PACOTES PARA LEITURA DE ARQUIVOS EXTERNOS

  install.packages("base")
  library(base)

#-----------------------------------------------------------------------------------------------------------------------------------------------------

  install.packages("readr")
  library(readr)

#-----------------------------------------------------------------------------------------------------------------------------------------------------

  install.packages("readxl")
  library(readxl)

#-----------------------------------------------------------------------------------------------------------------------------------------------------

  install.packages("xlsx")
  library(xlsx)

#-----------------------------------------------------------------------------------------------------------------------------------------------------

  install.packages("foreign")
  library(foreign)

#-----------------------------------------------------------------------------------------------------------------------------------------------------

  install.packages("data.table")
  library(data.table)

#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#USANDO O PACOTE utils

#Arquivos csv (comma separated value)
#O parâmetro header determina se a tabela tem ou não um cabeçalho e sep é o separador utilizado

#Caso o arquivo esteja na pasta de trabalho:
  
  tabela <- read.csv("tabela2_1.csv")

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Senão, devemos dar o endereço completo do arquivo

  tabela <- read.csv("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.csv")
  
#Definindo se o arquivo possui uma linha de cabeçalho  
  
  tabela <- read.csv2("tabela2_1.csv", header = TRUE)  
  
#Definindo o separador de dados
  
  tabela <- read.csv2("tabela2_1.csv", header = TRUE, sep = ";")
  
  
  tabela <- read.csv2("tabela2_1.csv", header = TRUE, sep = ";", dec = ",")  
  
  
  
  
  
  
  
  
  
  
  
  

#-----------------------------------------------------------------------------------------------------------------------------------------------------
#Visualizando o dataframe resultante
  
  View(tabela)
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#No Brasil, a vírgula é utilizada como ponto decimal e o ponto e vírgula é o separador, para isso, usamos a função read.csv2()  
  
  tabela <- read.csv2("tab2_1.csv")
  
  tabela <- read.csv2("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.csv", header = TRUE, sep = ";")
  
  
  
  
  
  
  tabela <- read.csv("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.csv", header = TRUE, sep = ";")  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#USANDO O PACOTE readr
  
#Com esse pacote podemos abrir arquivos com qualquer tipo de separador

#Caso o arquivo esteja na pasta de trabalho
  
  tabela <- read_delim("tabela2_1.csv", delim = ";")
 
#----------------------------------------------------------------------------------------------------------------------------------------------------- 
#Senão, devemos dar o endereço completo do arquiv  
  
  tabela <- read_delim("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.csv", delim = ";")   

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Importar arquivo .txt  
  
#Delimitados por ';' e suas 4 primeiras linhas
  
  tabela <- read_delim("tabela2_1.txt", delim = ";", n_max = 4)

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Ou se estiverem noutra pasta
  
  tabela <- read_delim("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.txt", delim = ";", n_max = 4)   
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#USANDO O PACOTE readxl 
  
#Se o arquivo estiver na pasta de trabalho:
  
  tabela <- read_xlsx("tabela2_1.xlsx")

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Se estiver noutra pasta:
   
  tabela <- read_xlsx("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.xlsx")
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#USANDO O PACOTE xlsx  
  
#Carregando planilha pelo índice da planilha no arquivo
  
  read.xlsx("Dados_EB.xlsx", sheetIndex = 5)
  
#Carregando planilha pelo nome da planilha no arquivo
  
  read.xlsx("Dados_EB.xlsx", sheetName = "CD-Municipios")
  
#Carregando planilha navegando pelo computador
  
  read.xlsx(file.choose(), sheetIndex = 5)  
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#USANDO O PACOTE data.table
  
#A função fread() é usada para importar grandes quantiddes de dados
  
#Se o arquivo estiver na pasta de trabalho:
  
  tabela <- fread("tabela2_1.xlsx")

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Se estiver noutra pasta:
  
  tabela <- fread("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.xlsx")

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#A função fread() retorna um data table se quisermos um dataframe:
  
  tabela <- fread("C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.xlsx", data.table = FALSE)
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#USANDO O PACOTE foreign 
  
#Abrindo arquivo .arff
  
  read.arff(file.choose())
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#BUSCA DE ARQUIVOS
  
#Buscar um arquivo pelo computador
  
  file.choose()

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#A função file.choose() devolve o caminho do arquivo buscado
  
  arquivo <- file.choose()  

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Ou com parâmetros  
  
  read.csv2(file.choose(), header = TRUE, sep = ";")  

#-----------------------------------------------------------------------------------------------------------------------------------------------------
#Ou salvando o arquivo em uma variável
  
  arquivo <- read.csv2(file.choose(), header = TRUE, sep = ";")    
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#BUSCANDO UM ARQUIVO COM file.path() 
  
#Devolve um caminho de arquivo
#Cada vírgula delimita uma pasta (nunca esquecer a extensão do arquivo)
  
  caminho <- file.path("C:","Users","Leandro Luz", "Desktop","RProject","DataSets","tabela2_1")

#----------------------------------------------------------------------------------------------------------------------------------------------------- 
#Por padrão, o separador é a vírgula, mas podemos definir outro
  
  caminho <- file.path("C:","Users","Leandro Luz", "Desktop","RProject","DataSets","tabela2_1", fsep = "*")
  
  caminho <- file.path("C:","Users","Leandro Luz", "Desktop","RProject","DataSets","tabela2_1", fsep = "/") 
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#RODANDO SCRIPTS EXTERNOS  

#Executar um script inteiro de um arquivo externo
  
  source("teste.R")

#-----------------------------------------------------------------------------------------------------------------------------------------------------  
#Ou pelo caminho completo
  
  source( "C:\\Users\\Leandro Luz\\Desktop\\RProject\\DataSets\\tabela2_1.xlsx")
  
#-----------------------------------------------------------------------------------------------------------------------------------------------------